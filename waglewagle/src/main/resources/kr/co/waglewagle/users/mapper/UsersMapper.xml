<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.waglewagle.users.mapper.UsersMapper">
	<select id="userInfo" resultType="kr.co.waglewagle.domain.UsersVO" parameterType="Integer">
		SELECT 
			users_id
			, users_nick 
			, users_name
			, users_gender
			, users_phone
			, users_rel
			, users_image
			, users_addr_list 
		FROM users WHERE users_id=#{users_id}
	</select>
	
	<select id="checkPoint" resultType="kr.co.waglewagle.domain.PointVO" parameterType="Integer">
		SELECT
			point_usable
			, point_total
		FROM point
		WHERE users_id=#{users_id}
	</select>
	
	<select id="checkFavorAreas" resultType="String" parameterType="Integer">
		SELECT
			users_addr_list
		FROM users
		WHERE users_id = #{users_id}
	</select>
	
	<update id="updateAreas" parameterType="java.util.Map">
		UPDATE users 
		SET users_addr_list = #{areas}
		WHERE users_id = #{users_id};
	</update>
	
	<select id="validPwd" resultType="int" parameterType="java.util.Map">
		SELECT
			COUNT(*)
		FROM users
		WHERE users_id = #{users_id} AND users_pwd = #{users_pwd}
	</select>
	<update id="pwdChange" parameterType="java.util.Map">
		UPDATE users
		SET users_pwd = #{users_pwd}
		WHERE users_id = #{users_id}
	</update>
	
	<select id="countQnas" resultType="Integer" parameterType="Integer">
		SELECT COUNT(*) FROM qnas WHERE users_id = #{users_id}
	</select>
	<select id="checkQnas" resultType="kr.co.waglewagle.domain.QnasVO" parameterType="java.util.Map">
		SELECT 
			row_number() over(order by qnas_date asc) as rownum
			, qnas_id 
			, qnas_title 
			, qnas_date
		FROM qnas
		WHERE users_id = #{users_id}
		ORDER BY qnas_date DESC
		LIMIT #{start_page}, 10;
	</select>
	
	<update id="deleteAccount" parameterType="Integer">
		UPDATE users SET users_status = 1 WHERE users_id = #{users_id}
	</update>
</mapper>